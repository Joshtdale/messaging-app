{"ast":null,"code":"const crypto = require(\"crypto\");\nconst util = require(\"./util\");\n\n/** Verifies and signs data against the key and secret.\n *\n * @constructor\n * @param {String} key app key\n * @param {String} secret app secret\n */\nfunction Token(key, secret) {\n  this.key = key;\n  this.secret = secret;\n}\n\n/** Signs the string using the secret.\n *\n * @param {String} string\n * @returns {String}\n */\nToken.prototype.sign = function (string) {\n  return crypto.createHmac(\"sha256\", this.secret).update(Buffer.from(string)).digest(\"hex\");\n};\n\n/** Checks if the string has correct signature.\n *\n * @param {String} string\n * @param {String} signature\n * @returns {Boolean}\n */\nToken.prototype.verify = function (string, signature) {\n  return util.secureCompare(this.sign(string), signature);\n};\nmodule.exports = Token;","map":{"version":3,"names":["crypto","require","util","Token","key","secret","prototype","sign","string","createHmac","update","Buffer","from","digest","verify","signature","secureCompare","module","exports"],"sources":["/workspace/messaging-app/app/node_modules/pusher/lib/token.js"],"sourcesContent":["const crypto = require(\"crypto\")\nconst util = require(\"./util\")\n\n/** Verifies and signs data against the key and secret.\n *\n * @constructor\n * @param {String} key app key\n * @param {String} secret app secret\n */\nfunction Token(key, secret) {\n  this.key = key\n  this.secret = secret\n}\n\n/** Signs the string using the secret.\n *\n * @param {String} string\n * @returns {String}\n */\nToken.prototype.sign = function (string) {\n  return crypto\n    .createHmac(\"sha256\", this.secret)\n    .update(Buffer.from(string))\n    .digest(\"hex\")\n}\n\n/** Checks if the string has correct signature.\n *\n * @param {String} string\n * @param {String} signature\n * @returns {Boolean}\n */\nToken.prototype.verify = function (string, signature) {\n  return util.secureCompare(this.sign(string), signature)\n}\n\nmodule.exports = Token\n"],"mappings":"AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMC,IAAI,GAAGD,OAAO,CAAC,QAAQ,CAAC;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA,SAASE,KAAK,CAACC,GAAG,EAAEC,MAAM,EAAE;EAC1B,IAAI,CAACD,GAAG,GAAGA,GAAG;EACd,IAAI,CAACC,MAAM,GAAGA,MAAM;AACtB;;AAEA;AACA;AACA;AACA;AACA;AACAF,KAAK,CAACG,SAAS,CAACC,IAAI,GAAG,UAAUC,MAAM,EAAE;EACvC,OAAOR,MAAM,CACVS,UAAU,CAAC,QAAQ,EAAE,IAAI,CAACJ,MAAM,CAAC,CACjCK,MAAM,CAACC,MAAM,CAACC,IAAI,CAACJ,MAAM,CAAC,CAAC,CAC3BK,MAAM,CAAC,KAAK,CAAC;AAClB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACAV,KAAK,CAACG,SAAS,CAACQ,MAAM,GAAG,UAAUN,MAAM,EAAEO,SAAS,EAAE;EACpD,OAAOb,IAAI,CAACc,aAAa,CAAC,IAAI,CAACT,IAAI,CAACC,MAAM,CAAC,EAAEO,SAAS,CAAC;AACzD,CAAC;AAEDE,MAAM,CAACC,OAAO,GAAGf,KAAK"},"metadata":{},"sourceType":"script","externalDependencies":[]}